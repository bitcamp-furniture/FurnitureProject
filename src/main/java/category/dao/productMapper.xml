<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="productSQL">
	<!-- 이미지 업로드 -->
	<insert id="categoryboardwrite" parameterType="product">
		insert into product values(seq_product.nextval
									, #{product_name}
									, #{product_price}
									, #{product_category1}
									, #{product_category2}
									, #{product_img_thumb}
									, #{product_img_detail}
									)
	</insert>
	
	
	<!-- startNum endNum -->
	<select id="selectList" parameterType="java.util.Map" resultType="product">
	<![CDATA[
			select * from 
			(select rownum rn, tt. * from 
	 		(select distinct PRODUCT_CODE, id, PRODUCT_PRICE, PRODUCT_CATEGORY_NAME, PRODUCT_CATEGORY1, PRODUCT_CATEGORY2, PRODUCT_COLOR   from product 
				where PRODUCT_CATEGORY1=(select PRODUCT_CATEGORY1 from category where CATENAME=#{category})
				or
				PRODUCT_CATEGORY2=(select PRODUCT_CATEGORY1 from category where CATENAME=#{category})
				order by id desc)tt) 
	 		where rn >= #{startNum} and rn <= #{endNum}
		]]>
	</select>
	
	
	<!--모든 리스트  -->
	 <select id="getAllList" resultType="product">
    <!-- 1행의 데이터를 어디에 담을예정?  -->
    <!-- resultType="패키지.class명"  -->
    <!-- 	select * from product -->
    	 SELECT *
		 FROM product
		 WHERE ROWNUM &lt;= 9
		 ORDER BY product_price desc	
    </select>   
    
    
    <!-- 선택한 카테고리 리스트 뿌리기 -->
	<select id="getSelectList" parameterType="java.util.Map" resultType="product">
		select * from product where PRODUCT_CATEGORY_NAME=#{category}
	</select>
	
	
	<!--product안에 있는 모든 것들 갯수  -->
	<select id="getTotalProduct" parameterType="String" resultType="int">
		select count(*) from product where PRODUCT_CATEGORY_NAME=#{category}
	</select>
	
	<!-- 검색 키워드 + 페이징 -->
	<select id="searchList" parameterType="java.util.Map" resultType="product">
	<![CDATA[
			select * from 
			(select rownum rn, tt. * from 
	 		(select * from product 
				where product_name like '%'||#{keyword}||'%'
				order by id desc)tt) 
	 		where rn >= #{startNum} and rn <= #{endNum}
		]]>
	</select>
	
	<!-- 검색 글 갯수 -->
	<select id="getSearchProduct" parameterType="String" resultType="int">
		select count(*) from product where PRODUCT_NAME like '%'||#{keyword}||'%'
	</select>
	
 </mapper>